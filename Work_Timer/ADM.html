<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>TimeTracker - Administrador</title>
    <link rel="stylesheet" type="text/css" href="./css/adm.css" />
    <!-- <script src="script.js"></script> -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>

<body>
    <div>
        <ul>
            <li>
                <div class="dropdown" style="float:left;">
                    <button class="dropbtn"><span class="material-icons">menu</span></button>
                    <div class="dropdown-content" style="left:0;">
                        <a href="http://localhost:8080/funcionarios">Editar Funcionários</a>
                        <a href="#">Funcionários</a>
                        <a href="#">Setor</a>
                    </div>
                </div>
            </li>
            <li style="float:right;"><a class="active" href="./index.html"><span class="material-icons">logout</span></a></li>
        </ul>
        <hr>
    </div>

    <center>
        <h2 style="font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif; margin: 15px 0;">
            Setor Sala de Máquinas</h2>
    </center>

    <div style="display: grid; grid-template-columns: 25% 75%">
        <div style="width:100%; height: auto;" class="DivTdsTarefas">
            <a href="#">
                <h4>Todas as tarefas</h4>
            </a>
        </div>
        <div style="width: 100%; height: auto;" class="AddTarefa">
            <a href="#"><button class="btn-adicionar">Adicionar Tarefa</button></a>
            <div class="Tarefas">
                <div class="cabe-tarefas">
                    <h4>Tarefa 1</h4><a href="#"><span class="material-icons expand-icon">chevron_right</span></a>
                </div>
                <div class="Recolhivel" style="display: none;">
                    <div class="dentroDaTarefa">
                        <textarea rows="5" cols="33" placeholder="Anotação..."></textarea>
                    </div>

                    <div id="timer">
                        <input type="text" id="timeInput" placeholder="Tempo Restante (em horas)" class="input-style">
                        <button id="startTimerButton" class="btn-timer">Iniciar Cronômetro</button>
                        <button id="resetTimerButton" class="btn-timer">Zerar Cronômetro</button>
                        <div id="timerDisplay">00:00</div>
                        <div class="btn-salvar" style="margin-left: 175%;"><button class="btn-adicionar">Salvar</button></div>                        
                    </div>
                    
                </div>
            </div>
        </div>
    </div>

    <script>
        // Função para controlar o evento de clique no ícone
        function toggleCollapse(event) {
            event.preventDefault(); // Impede o comportamento padrão do link
            // Obtém a div recolhível correspondente
            var collapsibleDiv = event.target.parentNode.parentNode.nextElementSibling;
            // console.log(event.target.parentNode.parentNode.nextElementSibling);

            // Alterna a exibição da div recolhível
            if (collapsibleDiv.style.display === 'none') {
                collapsibleDiv.style.display = 'block';
                event.target.textContent = "expand_less";
            } else {
                collapsibleDiv.style.display = 'none';
                event.target.textContent = "chevron_right";
            }
        }

        // Obtém todos os ícones de colapso
        var collapseIcons = document.getElementsByClassName('expand-icon');

        // Adiciona um ouvinte de eventos de clique a cada ícone
        for (var i = 0; i < collapseIcons.length; i++) {
            collapseIcons[i].addEventListener('click', toggleCollapse);

        }

        const startButton = document.getElementById('startTimerButton');
        const resetButton = document.getElementById('resetTimerButton');
        const timeInput = document.getElementById('timeInput');
        const display = document.getElementById('timerDisplay');
        let timerInterval;
        let isTimerActive = false;

        // Função para iniciar o cronômetro com o tempo digitado
        function startTimer(event) {
            if (event.key && event.key !== 'Enter') return; // Verifica se a tecla pressionada é "Enter"

            const time = parseFloat(timeInput.value); // Obtém o tempo digitado como um número decimal

            if (!isNaN(time) && time > 0) {
                const duration = time * 60 * 60; // Converte o tempo para segundos
                let timer = duration, minutes, seconds;
                clearInterval(timerInterval); // Limpa qualquer intervalo de timer existente

                // Função de atualização do cronômetro
                function updateTimer() {
                    minutes = parseInt(timer / 60, 10);
                    seconds = parseInt(timer % 60, 10);
                    minutes = minutes < 10 ? "0" + minutes : minutes;
                    seconds = seconds < 10 ? "0" + seconds : seconds;
                    display.textContent = minutes + ":" + seconds;

                    if (--timer < 0) {
                        clearInterval(timerInterval); // Interrompe o cronômetro quando o tempo acabar
                    }
                }

                // Inicia o cronômetro
                updateTimer();
                timerInterval = setInterval(updateTimer, 1000);
                isTimerActive = true;
            }
        }

        // Função para zerar o cronômetro e redefinir o campo de tempo
        function resetTimer() {
            clearInterval(timerInterval);
            display.textContent = '00:00';
            timeInput.value = '';
            isTimerActive = false;
        }

        // Adiciona ouvintes de eventos para os botões
        startButton.addEventListener('click', startTimer);
        resetButton.addEventListener('click', resetTimer);
        timeInput.addEventListener('keyup', startTimer); // Ouve o evento de pressionar tecla no campo de tempo

    </script>
</body>

</html>
